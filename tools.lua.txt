
local function getindex(t,id) 
for i,v in pairs(t) do 
if v == id then 
return i 
end 
end 
return nil 
end

local function reload_plugins( ) 
  plugins = {} 
  load_plugins() 
end

local function moody_sudo(user_id)
  for k,v in pairs(_config.sudo_users) do
    if user_id == v then
      return k
    end
  end
  -- If not found
  return false
end

local function sudolist(msg)
local sudo_users = _config.sudo_users
text = "*???   ŞÜÇÆÜãÜå ÇáÜãÜØÜæÑíÜä ?????  : *\n"
for i=1,#sudo_users do
    text = text..i.." - "..sudo_users[i].."\n"
end
return text
end


local function chat_list(msg)
	i = 1
	local data = load_data(_config.moderation.data)
    local groups = 'groups'
    if not data[tostring(groups)] then
        return "???  áÇ íÜæÌÜÏ ãÜÌÜãÜæÚÜÇÊ ãÜİÜÚÜáå ÍÜÇáÜíÜÇ "
    end
    local message = '???   ŞÜÇÆãÜå ÇáÜßÜÑæÈÜÇÊ  :\n\n'
    for k,v in pairsByKeys(data[tostring(groups)]) do
		local group_id = v
		if data[tostring(group_id)] then
			settings = data[tostring(group_id)]['settings']
		end
        for m,n in pairsByKeys(settings) do
			if m == 'set_name' then
				name = n:gsub("", "")
				chat_name = name:gsub("?", "")
				 group_name_id = name .. ' \n* ???  ÇíÜÏí : [<code>' ..group_id.. '</code>]\n'

					group_info = i..' Ü '..group_name_id

				i = i + 1
			end
        end
		message = message..group_info
    end
	send_msg(msg.to.id, message,nil,"html")
end

 function botrem(msg)
	local data = load_data(_config.moderation.data)
	if data[tostring(msg.to.id)] then
	data[tostring(msg.to.id)] = nil
	save_data(_config.moderation.data, data)
	local groups = 'groups'
	if not data[tostring(groups)] then
		data[tostring(groups)] = nil
		save_data(_config.moderation.data, data)
	end
	data[tostring(groups)][tostring(msg.to.id)] = nil
	save_data(_config.moderation.data, data)
	if redis:get('CheckExpire::'..msg.to.id) then
		redis:del('CheckExpire::'..msg.to.id)
	end
	if redis:get('ExpireDate:'..msg.to.id) then
		redis:del('ExpireDate:'..msg.to.id)
	end
	  leave_group(msg.to.id)
	end
  leave_group(msg.to.id)
end

local function warning(msg)
local expiretime = redis:ttl('ExpireDate:'..msg.to.id)
if expiretime == -1 then
return
else
local d = math.floor(expiretime / 86400) + 1
if tonumber(d) == 1 and not is_sudo(msg) and is_mod(msg) then
send_msg(msg.to.id,'???  íÑÌì ÇáÊæÇÕá ãÚ ãØæÑ ÇáÈæÊ áÊÌÏíÏ ÇÔÊÑÇß ÇáÈæÊ æÇáÇ ÓÇÎÑÌ ÊáŞÇÆíÇ ??', msg.id, 'md')
end
end
end
local function pre_process(msg)
if msg.to.type ~= 'private' then
local data = load_data(_config.moderation.data)
local gpst = data[tostring(msg.to.id)]
local chex = redis:get('CheckExpire::'..msg.to.id)
local exd = redis:get('ExpireDate:'..msg.to.id)
if gpst and not chex and msg.from.id ~= sudo_id and not is_sudo(msg) then
redis:set('CheckExpire::'..msg.to.id,true)
redis:set('ExpireDate:'..msg.to.id,true)
redis:setex('ExpireDate:'..msg.to.id, 86400, true)
send_msg(msg.to.id, '???  Êã ÏÚã ÇáãÌãæÚå áíæã æÇÍÏ \n???  ÑÇÓá ÇáãØæÑ áÊÌÏíÏ ÇáæŞÊ',msg.id,'md')
end
if chex and not exd and msg.from.id ~= sudo_id and not is_sudo(msg) then
local text1 = '??? ÇÔÊÑÇß ÇáãÌãæÚå ÇäÊåì  ??\n??? '..msg.to.title..'\n\nID:  <code>'..msg.to.id..'</code>'
local text2 = '??? ÇáÇÔÊÑÇß ÇáÈæÊ ÇäÊåì \n??? Óæİ ÇÛÇÏÑ \n??? áÊÌÏíÏ ÇáÇÔÊÑÇß ÑÇÓá '..botname
send_msg(sudo_id, text1, nil, 'html')
send_msg(msg.to.id, text2, msg.id, 'html')
botrem(msg)
else
local expiretime = redis:ttl('ExpireDate:'..msg.to.id)
local day = (expiretime / 86400)
if tonumber(day) > 0.208 and not is_sudo(msg) and is_mod(msg) then
warning(msg)
end
end
end
end


local function run(msg, matches)

local data = load_data(_config.moderation.data)

  if tonumber(msg.from.id) == tonumber(sudo_id) then
   if matches[1] == "ÑİÚ ãØæÑ" then
   if not matches[2] and msg.reply_to_message then
	if msg.reply.username then
	username = "@"..check_markdown(msg.reply.username)
    else
	username = escape_markdown(msg.reply.print_name)
end
      if msg.reply.id == our_id then return end
   if moody_sudo(tonumber(msg.reply.id)) then
    return "???  ÇáÜÚÜÖÜæ  :"..username.." \n???   ÇáÇíÜÏí :  ["..msg.reply.id.."]\n???  ÇÇäÜå ÈÜÇáÜÊÜÃßÜíÜÏ ãÜØÜæÑ ?????"
    else
          table.insert(_config.sudo_users, tonumber(msg.reply.id)) 
     save_config() 
     reload_plugins(true) 
    return "???  ÇáÜÚÜÖÜæ  :"..username.." \n???   ÇáÇíÜÏí :  ["..msg.reply.id.."]\n???   ÊÜã ÊÜÑŞÜíÜÊÜå áÜíÜÕÜÈÜÍ ãÜØÜæÑ ?????"
      end
  elseif matches[2] and matches[2]:match('^%d+') then
            if matches[2] == our_id then return end
   if not getUser(matches[2]).result then
   return "??? áÇ íæÌÏ ÚÖæ ÈåĞÇ ÇáãÚÑİ"
    end
	  local user_name = '@'..check_markdown(getUser(matches[2]).information.username)
	  if not user_name then
		user_name = escape_markdown(getUser(matches[2]).information.first_name)
	  end
   if moody_sudo(tonumber(matches[2])) then
     return "???  ÇáÜÚÜÖÜæ  :  "..user_name.."\n???  ÇáÇíÏí : ["..matches[2].."]\n???  ÇÇäÜå ÈÜÇáÜÊÜÃßÜíÜÏ ãÜØÜæÑ ?????"
    else
           table.insert(_config.sudo_users, tonumber(matches[2])) 
     save_config() 
     reload_plugins(true) 
    return "???  ÇáÜÚÜÖÜæ  :  "..user_name.."\n???  ÇáÇíÏí : ["..matches[2].."] \n???   ÊÜã ÊÜÑŞÜíÜÊÜå áÜíÜÕÜÈÜÍ ãÜØÜæÑ ?????"
   end
   elseif matches[2] and string.match(matches[2], '@[%a%d_]')  then
    local status = resolve_username(matches[2])
         if status.information.id == our_id then return end
   if not resolve_username(matches[2]).result then
   return "???áÇ íæÌÏ ÚÖæ ÈåĞÇ ÇáãÚÑİ"
end
if moody_sudo(tonumber(status.information.id)) then
     return "???  ÇáÜÚÜÖÜæ  :  @"..check_markdown(status.information.username).."\n???  ÇáÇíÏí : ["..status.information.id.."] \n???  ÇÇäÜå ÈÜÇáÜÊÜÃßÜíÜÏ ãÜØÜæÑ ?????"
    else
          table.insert(_config.sudo_users, tonumber(status.information.id)) 
     save_config() 
     reload_plugins(true) 
    return "???  ÇáÜÚÜÖÜæ  :  @"..check_markdown(status.information.username).."\n???  ÇáÇíÏí : ["..status.information.id.."] \n???   ÊÜã ÊÜÑŞÜíÜÊÜå áÜíÜÕÜÈÜÍ ãÜØÜæÑ ?????"
     end
  end
end
   if matches[1] == "ÊäÒíá ãØæÑ" then
      if not matches[2] and msg.reply_to_message then
	if msg.reply.username then
	username = "@"..check_markdown(msg.reply.username)
    else
	username = escape_markdown(msg.reply.print_name)
end
if tonumber(msg.reply.id) == tonumber(our_id) then return end
   if not moody_sudo(tonumber(msg.reply.id)) then
    return "???  ÇáÜÚÜÖÜæ  :"..username.." \n???   ÇáÇíÜÏí :  ["..msg.reply.id.."]\n???  ÇäÜå ÈÜÇáÜÊÜÃßÜíÜÏ ÊÜã ÊÜäÜÒíÜáÜå ãÜä ÇáÜãÜØÜæÑíÜä ?????"
    else
          table.remove(_config.sudo_users, getindex( _config.sudo_users, tonumber(msg.reply.id)))
		save_config()
     reload_plugins(true) 
    return "???  ÇáÜÚÜÖÜæ  :"..username.." \n???   ÇáÇíÜÏí :  ["..msg.reply.id.."]\n???  ÊÜã ÊÜäÜÒíÜáÜå ãÜä ÇáÜãÜØÜæÑíÜä  ?????"
      end
	  elseif matches[2] and matches[2]:match('^%d+') then
 if tonumber(matches[2]) == tonumber(our_id) then return end
  if not getUser(matches[2]).result then
   return "??? áÇ íæÌÏ ÚÖæ ÈåĞÇ ÇáãÚÑİ"
    end
	  local user_name = '@'..check_markdown(getUser(matches[2]).information.username)
	  if not user_name then
		user_name = escape_markdown(getUser(matches[2]).information.first_name)
	  end
   if not moody_sudo(tonumber(matches[2])) then
    return "???  ÇáÜÚÜÖÜæ  :  "..user_name.." \n???   ÇáÇíÜÏí :  ["..matches[2].."]\n???  ÇäÜå ÈÜÇáÜÊÜÃßÜíÜÏ ÊÜã ÊÜäÜÒíÜáÜå ãÜä ÇáÜãÜØÜæÑíÜä ?????"
    else
          table.remove(_config.sudo_users, getindex( _config.sudo_users, tonumber(matches[2])))
		save_config()
     reload_plugins(true) 
    return "???  ÇáÜÚÜÖÜæ  :  "..user_name.." \n???   ÇáÇíÜÏí :  ["..matches[2].."] \n???  ÊÜã ÊÜäÜÒíÜáÜå ãÜä ÇáÜãÜØÜæÑíÜä  ?????"
      end
elseif matches[2] and string.match(matches[2], '@[%a%d_]')  then
      local status = resolve_username(matches[2])
   if tonumber(status.id) == tonumber(our_id) then return end

   if not resolve_username(matches[2]).result then
   return "??? áÇ íæÌÏ ÚÖæ ÈåĞÇ ÇáãÚÑİ"
    end
   if not moody_sudo(tonumber(status.information.id)) then
    return "???  ÇáÜÚÜÖÜæ  :  @"..check_markdown(status.information.username).." \n???   ÇáÇíÜÏí :  ["..status.information.id.."] \n???  ÇäÜå ÈÜÇáÜÊÜÃßÜíÜÏ ÊÜã ÊÜäÜÒíÜáÜå ãÜä ÇáÜãÜØÜæÑíÜä ?????"
    else
          table.remove(_config.sudo_users, getindex( _config.sudo_users, tonumber(status.information.id)))
		save_config()
     reload_plugins(true) 
    return "???  ÇáÜÚÜÖÜæ  :  @"..check_markdown(status.information.username).." \n???   ÇáÇíÜÏí :  ["..status.information.id.."] \n???  ÊÜã ÊÜäÜÒíÜáÜå ãÜä ÇáÜãÜØÜæÑíÜä  ?????"
          end
      end
   end
end

if is_sudo(msg) then



  
if matches[1] == 'ÇáãÌãæÚÇÊ' then
return chat_list(msg)
    end
if matches[1] == 'ÊÚØíá' and matches[2] and string.match(matches[2], '^%d+$') then
    local data = load_data(_config.moderation.data)
			-- Group configuration removal
			data[tostring(matches[2])] = nil
			save_data(_config.moderation.data, data)
			local groups = 'groups'
			if not data[tostring(groups)] then
				data[tostring(groups)] = nil
				save_data(_config.moderation.data, data)
			end
			data[tostring(groups)][tostring(matches[2])] = nil
			save_data(_config.moderation.data, data)
	   send_msg(matches[2], "??? Êã ÊÚØíá ÇáÈæÊ ãä ŞÈá ÇáãØæÑ", nil, 'md')
    send_msg(msg.to.id , '??? ÇáãÌãæÚå : *'..matches[2]..'* Êã ÊÚØíáåÇ')
		end
  if matches[1] == 'ÇĞÇÚå' and matches[2]  then	
if tonumber(msg.from.id) ~= tonumber(sudo_id) then return " åĞÇ ÇáÇãÑ ááãØæÑ ÇáÇÓÇÓí İŞØ ???" end
  local data = load_data(_config.moderation.data)		
  local bc = matches[2]		
  local i = 1
  for k,v in pairs(data) do				
send_msg(k, bc)
i = i+1
end	
send_msg(msg.to.id, '??? Êã ÇĞÇÚå ÇáÑÓÇáå Çáì ['..i..'] ãÌãæÚå ')

end
if matches[2] == 'ÇáÎÑæÌ ÇáÊáŞÇÆí' and is_sudo(msg) then
--Enable Auto Leave
     if matches[1] == 'ÊÚØíá' then
    redis:del('AutoLeaveBot')
     return '??? Êã ÊÚØíá ÇáÎÑæÌ ÇáÊáŞÇÆí'
--Disable Auto Leave
     elseif matches[1] == 'ÊİÚíá' then
    redis:set('AutoLeaveBot', true)
 return '??? Êã ÊİÚíá ÇáÎÑæÌ ÇáÊáŞÇÆí'
--Auto Leave Status
end
end
if matches[1] =="ÇáÎÑæÌ ÇáÊáŞÇÆí" then
if redis:get('AutoLeaveBot') then
return '??? ÇáÎÑæÌ ÇáÊáŞÇÆí: ãİÚá'
else
return '??? ÇáÎÑæÌ ÇáÊáŞÇÆí: ãÚØá'
end
end


if msg.to.type == 'supergroup' or msg.to.type == 'group' then



 if not data[tostring(msg.to.id)] then return end


if matches[1] == 'ÔÍä' and matches[2] and not matches[3] and is_sudo(msg) then
if tonumber(matches[2]) > 0 and tonumber(matches[2]) < 1001 then
local extime = (tonumber(matches[2]) * 86400)
redis:setex('ExpireDate:'..msg.to.id, extime, true)
if not redis:get('CheckExpire::'..msg.to.id) then
redis:set('CheckExpire::'..msg.to.id)
end
send_msg(msg.to.id, '???Êã ÔÍä ÇáÇÔÊÑÇß á\n [<code>'..matches[2]..'</code>] íæã ??',msg.id, 'html')
send_msg(sudo_id, ' ???Êã ÊãÏíÏ İÊÑå ÇáÇÔÊÑÇß áÜ[<code>'..matches[2]..'</code>].\n ??? İí ÇáãÌãæÚå\n??? [<code>'..msg.to.title..'</code>]',nil, 'html')
else
send_msg(msg.to.id,  '_ ÇÎÊÑ ãä 1 Çáì 1000 İŞØ ??    ._',msg.id, 'md')
end
end

if matches[1]:lower() == 'ÇáÇÔÊÑÇß' and is_mod(msg) and not matches[2] then
local expi = redis:ttl('ExpireDate:'..msg.to.id)
if expi == -1 then
	send_msg(msg.to.id, '_ÇáãÌãæÚå ãİÚáå ãÏì ÇáÍíÇå??_', msg.id, 'md')
else
local day = math.floor(expi / 86400) + 1
if expi == -1 then
	expire_date = 'ãİÊæÍ????'
    elseif day == 1 then
	expire_date = 'íæã æÇÍÏ' 
	elseif day == 2 then
   	expire_date = 'íæãíä'
	elseif day <= 10 then
   	expire_date = day..' ÇíÇã'
   	else
	expire_date = day..' íæã'
end
 send_msg(msg.to.id, '??? ÈÇŞí '..day..' æíäÊåí ÇÔÊÑÇß ÇáÈæÊ ????', msg.id, 'md')
end
end

if matches[1]:lower() == 'ÇáÇÔÊÑÇß' and matches[2] == '1' and not matches[3] then
			local timeplan1 = 2592000
			redis:setex('ExpireDate:'..msg.to.id, timeplan1, true)
			if not redis:get('CheckExpire::'..msg.to.id) then
				redis:set('CheckExpire::'..msg.to.id,true)
			end
send_msg(sudo_id, '??? Êã ÊİÚíá ÇáãÌãæÚå\n???  [ <code>'..msg.to.title..'</code> ]\n???ÇáÇÔÊÑÇß : ÔåÑ æÇÍÏ ?? )' , nil, 'html')
send_msg(msg.to.id, '??? Êã ÊİÚíá ÇáãÌãæÚå ÓÊÈŞí ÕÇáÍå Çáí 30 íæã??', msg.id, 'md')
		end
if matches[1]:lower() == 'ÇáÇÔÊÑÇß' and matches[2] == '2' and not matches[3] then
			local timeplan2 = 7776000
			redis:setex('ExpireDate:'..msg.to.id,timeplan2,true)
			if not redis:get('CheckExpire::'..msg.to.id) then
				redis:set('CheckExpire::'..msg.to.id,true)
			end
send_msg(sudo_id, '??? Êã ÊİÚíá ÇáãÌãæÚå \n??? [ <code>'..msg.to.title..'</code> ]\n??? ÇáÇÔÊÑÇß : 3 ÇÔåÑ ?? )', nil, 'html')
send_msg(msg.to.id, '??? Êã ÊİÚíá ÇáÈæÊ ÈäÌÇÍ æÕáÇÍíÊå áãÏå 90 íæã  )', msg.id, 'md')
		end
if matches[1]:lower() == 'ÇáÇÔÊÑÇß' and matches[2] == '3' and not matches[3] then
			redis:set('ExpireDate:'..msg.to.id,true)
			if not redis:get('CheckExpire::'..msg.to.id) then
				redis:set('CheckExpire::'..msg.to.id,true)
			end
send_msg(sudo_id, '??? Êã ÊİÚíá ÇáãÌãæÚå \n??? [ <code>'..msg.to.title..'</code> ]\n??? ÇáÇÔÊÑÇß : ãÏì ÇáÍíÇå', nil, 'html')
send_msg(msg.to.id, '??? Êã ÊİÚíá ÇáÈæÊ ÈäÌÇÍ æÕáÇÍíÊå ãÏì ÇáÍíÇå ', msg.id, 'md')
end
end



end
---------------Help Tools----------------
  
if matches[1] == 'ÇáÓæÑÓ' and data[tostring(msg.to.id)]  then
send_msg(msg.to.id, _config.info_text, msg.id)
end
if matches[1] == "ÇáãØæÑíä" and data[tostring(msg.to.id)] and is_sudo(msg) then
return sudolist(msg)
end


if matches[1]:lower() == 'ãÚáæãÇÊí' or matches[1]:lower() == 'ãæŞÚí'  then
if msg.from.username then username = '@'..msg.from.username
else username = '<i>ãÇ ãÓæí  ????</i>'
end
if is_sudo(msg) then rank = 'ÇáãØæÑ ãÇáÊí ??'
elseif is_owner(msg) then rank = 'ãÏíÑ ÇáãÌãæÚå ??'
elseif is_mod(msg) then rank = 'ÇÏãä İí ÇáÈæÊ ??'
elseif is_whitelist (msg) then rank = '?? ÚÖæ ããíÒ'
else rank = 'ãÌÑÏ ÚÖæ ??'
end
local info = '<b>?????? ÇåÜáÇ ÈÜß ãÚáæãÇÊß :</b>\n\n<b>??? ÇáÇÓã :</b> <i>'..(msg.from.first_name)..'</i>\n<b>??? ÇáãÚÑİ:</b> '..username
..'\n<b>??? ÇáÇíÏí :</b> [ <code>'..msg.from.id
..'</code> ]\n<b>??? ÇíÏí ÇáßÑæÈ :</b> [ <code>'..msg.to.id
..'</code> ]\n<b>??? ãæŞÚß :</b> <i>'..rank..'</i>'
send_msg(msg.to.id, info, msg.id, 'html')
end
 if matches[1] == "ãæÇáíÏí" then
local kyear = tonumber(os.date("%Y"))
local kmonth = tonumber(os.date("%m"))
local kday = tonumber(os.date("%d"))
--
local agee = kyear - matches[2]
local ageee = kmonth - matches[3]
local ageeee = kday - matches[4]

return  " ???? ãÑÍÈÇ ÚÒíÒí"
.."\n???? áŞÏ ŞãÊ ÈÍÓÈ ÚãÑß ????  \n\n"

.."??? "..agee.." Óäå\n"
.."??? "..ageee.." ÇÔåÑ \n"
.."??? "..ageeee.." íæã \n\n"

end
-------



if matches[1] == "ÇáÇæÇãÑ" then
if not is_mod(msg) then return "??? ááÇÏÇÑííä İŞØ ????" end
local usersudo = string.gsub(_config.sudouser, '@', '')
keyboard = {}
keyboard.inline_keyboard = {
{
{text= '   ÊÍÏË ãÚ ÇáãØæÑ ' ,url = 'https://t.me/'..usersudo} -- åäÇ Îáí ãÚÑİß ÇäÊå ßãØæÑ
}					
}
tkey = [[
?????ãÑÍÈÜÇ Èß íÇÚÒíÒí ÇáÇæÇãÑ ????
??À????????
???ã1 ?? ÇæÇãÑ ÇáÇÏÇÑÉ
???ã2 ?? ÇæÇãÑ ÇÚÏÇÏÊ ÇáßÑæÈ
???ã3 ?? ÇæÇãÑ ÇáÍãÇíÉ 
???ã4 ?? ÇáÇæÇãÜÑ ÇáÜ?ÜÇãå 
???ã5 ?? ÇæÇãÑ ÇÖÇİå ÑÏæÏ
???ã6 ?? ÇæÇãÑ ÇáÒÎÑİå
???ã ÇáãØæÑ ?? ááãØæÑ İŞØ 
?? À????????
?????ÇÖÛØ ááÊÍÏË ãÚ ÇáãØæÑ ????
]]
send_key(msg.chat.id, tkey, keyboard, msg.message_id, "html")
end
if matches[1]== 'ã1' then
if not is_mod(msg) then return "?? ? ááÇÏÇÑííä İŞØ ????" end
local usersudo = string.gsub(_config.sudouser, '@', '')
keyboard = {}
keyboard.inline_keyboard = {
{
{text= '   ÊÍÏË ãÚ ÇáãØæÑ ' ,url = 'https://t.me/'..usersudo} -- åäÇ Îáí ãÚÑİß ÇäÊå ßãØæÑ
}					
}
tkey = [[
????? ãÑÍÈÇ ÚÒíÒí ÇæÇãÑ ÇáÇÏÇÑÉ ????
??À????????
?????ÇæÇãÑ ÇáÊäÒíá æÇáÑİÚ ÈÜ ÇáÈæÊ????
??À????????
??? ÑİÚ ÇÏãä ?? áÑİÚ ÇÏãä 
???ÊäÒíá ÇÏãä ?? áÊäÒíá ÇÏãä
???ÑİÚ ÚÖæ ããíÒ ?? áÑİÚ ããíÒ 
???ÊäÒíá ÚÖæ ããíÒ?áÊäÒíá ããíÒ 
??? ÇáÇÏãäíå ?? áÚÑÖ ÇáÇÏãäíå
??? ÇáÇÏÇÑííä ??áÚÑÖ ÇáÇÏÇÑííä
??À????????
????? ÇæÇãÑ ÇáØÑÏ æÇáÍÖÑ 
??À????????
??? ØÑÏ ÈÇáÑÏ ?? áØÑÏ ÇáÚÖæ 
??? ÍÙÑ ÈÇáÑÏ ??áÍÙÑ æØÑÏ 
??? ÇáÛÇÁ ÇáÍÙÑ ?? áÇáÛÇÁ ÇáÍÙÑ 
??? ãäÚ ??áãäÚ ßáãå İí ÇáßÑæÈ
??? ÇáÛÇÁ ãäÚ ??áÇáÛÇÁ ãäÚ Çáßáãå  
??? ßÊã ?? áßÊã ÚÖæ  
??? ÇáÛÇÁ ÇáßÊã?? áÇáÛÇÁ ÇáßÊã 
??À????????
????? ÇÖÛØ ááÊÍÏË ãÚ ÇáãØæÑ ????
]]
send_key(msg.chat.id, tkey, keyboard, msg.message_id, "html")
end
if matches[1]== 'ã2' then
if not is_mod(msg) then return "?? ? ááÇÏÇÑííä İŞØ ????" end
local usersudo = string.gsub(_config.sudouser, '@', '')
keyboard = {}
keyboard.inline_keyboard = {
{
{text= '  ÊÍÏË ãÚ ÇáãØæÑ ' ,url = 'https://t.me/'..usersudo} -- åäÇ Îáí ãÚÑİß ÇäÊå ßãØæÑ
}					
}
tkey = [[
?????ãÑÍÈÇ ÚÒíÒí ÇæÇãÑ ÇÚÏÇÏÊ????
??À????????
????? ÇæÇãÑ ÇáæÖÚ ááãÌãæÚå????
??À????????
???ÖÚ ÇáÊÑÍíÈ??áæÖÚ ÊÑÍíÈ  
??? ÖÚ ŞæÇäíä?? áæÖÚ ŞæÇäíä 
??? ÖÚ æÕİ ?? áæÖÚ æÕİ    
??? ÇáÑÇÈØ ?? áÚÑÖ ÇáÑÇÈØ  
???À???????????
????? ÇæÇãÑ ÑÄíå ÇáÇÚÏÇÏÇÊ ????
???À????????????
??? ÇáŞæÇäíä ??áÚÑÖ ÇáŞæÇäíä  
??? ÇáãßÊæãíä ??áÚÑÖ ÇáãßÊæãíä 
??? ÇáãØæÑ ?? áÚÑÖ ÇáãØæÑ 
??? ãÚáæãÇÊí ??áÚÑÖ ãÚáæãÇÊß  
??? ÇáÍãÇíå ?? áÚÑÖ ÇÚÏÇÏÇÊ 
???ÇáæÓÇÆØ ??áÚÑÖ  ÇáãíÏíÇ 
???ÇáãÌãæÚå ?ãÚáæãÇÊ ÇáãÌãæÚå 
??À????????
?????ÇÖÛØ ááÊÍÏË ãÚ ÇáãØæÑ ????
]]
send_key(msg.chat.id, tkey, keyboard, msg.message_id, "html")
end
if matches[1]== 'ã3' then
if not is_mod(msg) then return "?? ? ááÇÏÇÑííä İŞØ ????" end
local usersudo = string.gsub(_config.sudouser, '@', '')
keyboard = {}
keyboard.inline_keyboard = {
{
{text= '   ÊÍÏË ãÚ ÇáãØæÑ  ' ,url = 'https://t.me/'..usersudo} -- åäÇ Îáí ãÚÑİß ÇäÊå ßãØæÑ
}					
}
tkey = [[
?????ãÑÍÈÇ ÚÒíÒí ÇæÇãÑ ÍãÇíå????
??À????????
????? ÇæÇãÑ ÍãÇíå ÇáãÌãæÚå ??
??À????????
???Şİá? İÊÍ ?  ÇáÊËÈíÊ
???Şİá? İÊÍ ? ÇáÊÚÏíá
???Şİá? İÊÍ ? ÇáÈÕãÇÊ
???Şİá? İÊÍ ? ÇáÜİíÏíæ
???Şİá? İÊÍ ? ÇáÜÕæÊ 
???Şİá? İÊÍ ?  ÇáÜÕæÑ 
???Şİá? İÊÍ ? ÇáãáÕŞÇÊ
???Şİá? İÊÍ ? ÇáãÊÍÑßå
???Şİá? İÊÍ ? ÇáÏÑÏÔå
???Şİá? İÊÍ ? ÇáãáÕŞÇÊ
???Şİá? İÊÍ ? ÇáÑæÇÈØ
???Şİá? İÊÍ ?ÇáÊÇß
???Şİá? İÊÍ ? ÇáÈæÊÇÊ
???Şİá? İÊÍ ? ÇáÈæÊÇÊ ÈÇáØÑÏ
???Şİá? İÊÍ ? ÇáßáÇíÔ
???Şİá? İÊÍ ? ÇáÊßÑÇÑ
???Şİá? İÊÍ ? ÇáÊæÌíå
???Şİá? İÊÍ ? ÇáÌåÇÊ 
???Şİá? İÊÍ ? ÇáãÌãæÚå 
???Şİá? İÊÍ ? ÇáãÇÑßÏæä
??À????????
???ÊÔÛíá? ÇíŞÇİ ? ÇáÊÑÍíÈ 
???ÊÔÛíá? ÇíŞÇİ ? ÇáÑÏæÏ 
???ÊÔÛíá? ÇíŞÇİ ? ÇáÊÍĞíÑ
???ÊÔÛíá? ÇíŞÇİ ? ÇáÇíÏí
??À????????
????? ÇÖÛØ ááÊÍÏË ãÚ ÇáãØæÑ ????
]]
send_key(msg.chat.id, tkey, keyboard, msg.message_id, "html")
end
if matches[1]== 'ã4' then
if not is_mod(msg) then return "?? ? ááÇÏÇÑííä İŞØ ????" end
local usersudo = string.gsub(_config.sudouser, '@', '')
keyboard = {}
keyboard.inline_keyboard = {
{
{text= '   ÊÍÏË ãÚ ÇáãØæÑ  ' ,url = 'https://t.me/'..usersudo} -- åäÇ Îáí ãÚÑİß ÇäÊå ßãØæÑ
}					
}
tkey = [[
?????ãÑÍÈÇ ÚÒíÒí ÇæÇãÑ ÇÖÇİíå???? 
??À????????
??? ãÚáæãÇÊß ÇáÔÎÕíå ????
??? ÇÓãí ? áÚÑÖ ÇÓãß ??
??? ÑÊÈÊí ? áÚÑÖ ÑÊÈÊß ??
??? ÇáÑÊÈå ? áÚÑÖ ÇáÑÊÈå ??
??? ãÚÑİí ? áÚÑÖ ãÚÑİß ??
??? ÇíÏíí ? áÚÑÖ ÇíÏíß ??
??? ÑŞãí ? áÚÑÖ ÑŞãß  ??
??À????????
????? ÇæÇãÑ ÇáÊÍÔíÔ ????
??À????????
??? ÊÍÈ + (ÇÓã ÇáÔÎÕ)
??? ÈæÓ + (ÇÓã ÇáÔÎÕ) 
??? ßæá + (ÇÓã ÇáÔÎÕ) 
??? ßáå + ÇáÑÏ + (ÇáßáÇã) 
??À????????
?????ÇÖÛØ ááÊÍÏË ãÚ ÇáãØæÑ ????
]]
send_key(msg.chat.id, tkey, keyboard, msg.message_id, "html")
end
if matches[1]== "ã ÇáãØæÑ" then
if not is_sudo(msg) then return "?? ? ááãØæíä İŞØ ????" end
local usersudo = string.gsub(_config.sudouser, '@', '')
keyboard = {}
keyboard.inline_keyboard = {
{
{text= '   ÊÍÏË ãÚ ÇáãØæÑ  ' ,url = 'https://t.me/'..usersudo} -- åäÇ Îáí ãÚÑİß ÇäÊå ßãØæÑ
}					
}
tkey = [[
?????ãÑÍÈÇ ãØæÑí ÇæÇãÑß ????
??À????????
??? ÊİÚíá  ? áÊİÚíá ÇáÈæÊ 
??? ÊÚØíá ? áÊÚØíá ÇáÈæÊ
 ??? ÇáÇÔÊÑÇß 1 ? áÊİÚíá ÇáÈæÊ 1 ÔåÑ
??? ÇáÇÔÊÑÇß 2 ? áÊİÚíá ÇáÈæÊ 3 ÇÔåÑ 
??? ÇáÇÔÊÑÇß 3 ? áÊİÚíá ÇáÈæÊ ãÏì ÇáÍíÇå
??? ÇĞÇÚå ? áäÔÑ İí ßá ÇáßÑæÈÇÊ
???ÇÓã ÇáÈæÊ + ÛÇÏÑ ? áØÑÏ ÇáÈæÊ
??? ãÓÍ ÇáÇÏãäíå ? áãÓÍ ÇáÇÏãäíå 
??? ãÓÍ ÇáÇÏÇÑííä? áãÓÍ ÇáÇÏÇÑííä 
??? ÊÍÏíË ? áÊÍÏíË ÇáãáİÇÊ 
???ÇæÇãÑ ÇáãáİÇÊ ?áÚÑÖ ÇáÇæÇãÑ
???À????????
????? ÇÖÛØ ááÊÍÏË ãÚ ÇáãØæÑ
]]
send_key(msg.chat.id, tkey, keyboard, msg.message_id, "html")
end
if matches[1]== 'ã5' then
if not is_owner(msg) then return "?? ? ááãÏÑÇÁ İŞØ ????" end
local usersudo = string.gsub(_config.sudouser, '@', '')
keyboard = {}
keyboard.inline_keyboard = {
{
{text= '   ÊÍÏË ãÚ ÇáãØæÑ  ' ,url = 'https://t.me/'..usersudo} -- åäÇ Îáí ãÚÑİß ÇäÊå ßãØæÑ
}					
}
tkey = [[
????? ãÑÍÈÇ ÚÒíÒí ÇæÇãÑ ÇáÑÏæÏ ????
??À????????
??? ÇáÑÏæÏ ? áÚÑÖ ÇáÑÏæÏ ÇáãËÈÊå
??? ÑÏ ÇÖİ + ÇáÑÏ ? ÃÖÇİÉÑÏ ÌÏíÏ
??? ÑÏ ãÓÍ  + ÇáÑÏ ? ÇáãÑÇÏ ãÓÍå
??? ÑÏ ãÓÍ Çáßá ? áãÓÍ Çáßá
??À????????
????? ÇÖÛØ ááÊÍÏË ãÚ ÇáãØæÑ ????
]]
send_key(msg.chat.id, tkey, keyboard, msg.message_id, "html")
end
if matches[1]== "ã6" then
if not is_mod(msg) then return "?? ? ááÇÏÇÑííä İŞØ ????" end
local usersudo = string.gsub(_config.sudouser, '@', '')
keyboard = {}
keyboard.inline_keyboard = {
{
{text= '   ÊÍÏË ãÚ ÇáãØæÑ  ' ,url = 'https://t.me/'..usersudo} -- åäÇ Îáí ãÚÑİß ÇäÊå ßãØæÑ
}					
}
tkey = [[
?????ãÑÍÈÇ ÚÒíÒí ÇæÇãÑ ÒÎÑİå????
??À????????
???ÒÎÑİ+Çáßáãå áÒÎÑİå ÈÇáÇäßáÔ
???ÒÎÑİå+Çáßáãå áÒÎÑİå ÈÇáÚÑÈí 
??À ????????
?????ÇÖÛØ ááÊÍÏË ãÚ ÇáãØæÑ ????
]]
send_key(msg.chat.id, tkey, keyboard, msg.message_id, "html")
end
if matches[1]== "ÇæÇãÑ ÇáãáİÇÊ" then
if not is_sudo(msg) then return "?? ? ááãØæíä İŞØ ????" end
local usersudo = string.gsub(_config.sudouser, '@', '')
keyboard = {}
keyboard.inline_keyboard = {
{
{text= '   ÊÍÏË ãÚ ÇáãØæÑ  ' ,url = 'https://t.me/'..usersudo} -- åäÇ Îáí ãÚÑİß ÇäÊå ßãØæÑ
}					
}
tkey = [[
????? HELLO YOU SUDO MY ??
??????????
??? /p | áÚÑÖ ŞÇÆãå ÇáãáİÇÊ 
??? /p + ÇÓã Çáãáİ ÇáãÑÇÏ ÊİÚíáå 
??? /p - ÇÓã Çáãáİ ÇáãÑÇÏ ÊÚØíáå 
??? sp + ÇáÇÓã | áÇÑÓÇá Çáãáİ Çáíß 
??? dp + ÇÓã Çáãáİ ÇáãÑÇÏ ÍĞİå 
??? sp all | áÇÑÓÇáß ßá ãáİÇÊ
??À ????????
?????ÇÖÛØ ááÊÍÏË ãÚ ÇáãØæÑ ????
]]
send_key(msg.chat.id, tkey, keyboard, msg.message_id, "html")
end
if matches[1]=="ÇáãØæÑ" then
local usersudo = string.gsub(_config.sudouser, '@', '')
keyboard = {}
keyboard.inline_keyboard = {
{
{text= '   ÊÍÏË ãÚ ÇáãØæÑ  ' ,url = 'https://t.me/'..usersudo} -- åäÇ Îáí ãÚÑİß ÇäÊå ßãØæÑ
}					
}
tkey = [[??? ?E??O?E ?Y ?E??

?------?------?

??? S??O ? @TH3BOSS

??? T?? ? @TH3BOSSBOT

??? TH3BOSS ? Final Version 21

?------?------?

??? ?? ? @llDEV1ll ]]
send_key(msg.chat.id, tkey, keyboard, msg.message_id, "html")
end
if matches[1]=="start" then
local usersudo = string.gsub(_config.sudouser, '@', '')
keyboard = {}
keyboard.inline_keyboard = {
{
{text= '   ÊÍÏË ãÚ ÇáãØæÑ  ' ,url = 'https://t.me/'..usersudo} -- åäÇ Îáí ãÚÑİß ÇäÊå ßãØæÑ
}					
}
tkey = [[??? ãÑÍÈÇ ÇäÇ ÈæÊ ÇÓãí ]].._config.botname..[[ ??
??? ÇŞæã ÈÍãÇíå ÇáãÌãæÚÇÊ ÍÊì 20k 
??? ÇáãØæÑ İŞØ íÓÊØíÚ ÊİÚíáí İí ÇáãÌãæÚÇÊ ??
??? Çæ ÇÊÑß ÑÓÇáÊß åäÇ æÓæİ íÑÏ Úáíß ÇáãØæÑ ]]
send_key(msg.chat.id, tkey, keyboard, msg.message_id, "html")
end

if matches[1]=="ÑÊÈÊí" and not matches[2] then
if is_sudo(msg) then
rank = 'ÇáãØæÑ ãÇáÊí ??'
elseif is_owner(msg) and msg.to.type ~= 'private'  then
rank = 'ãÏíÑ ÇáãÌãæÚå ??'
elseif is_mod(msg) and msg.to.type ~= 'private'  then
rank = ' ÇÏãä İí ÇáÈæÊ ??'
elseif  is_whitelist(msg.from.id, msg.to.id) and msg.to.type ~= 'private' then
rank = 'ÚÖæ ããíÒ ??'
else
if msg.to.type ~= 'private' then
rank = 'ãÌÑÏ ÚÖæ ??'
else
rank = 'áÓÊ ãØæÑ İí ÇáÓæÑÓ ??'
end
end
return '??? ÑÊÈÊß : '..rank
end

if matches[1]=="ÇáÑÊÈå" and not matches[2] and is_owner(msg) and not  msg.to.type ~= 'private' then
if msg.reply_id then
if msg.reply.id == our_id  then
rank = 'åĞÇ ÇáÈæÊ ?????'
elseif msg.reply.id == msg.from.id  then
rank = 'ÇäÊå ÇáãØæÑ ??????'
elseif is_sudo1(msg.reply.id) then
rank = 'ÇáãØæÑ åĞÇ ??'
elseif is_owner1( msg.to.id,msg.reply.id) then
rank = 'ãÏíÑ ÇáãÌãæÚå ??'
elseif is_mod1( msg.to.id,msg.reply.id) then
rank = ' ÇÏãä İí ÇáÈæÊ ??'
elseif is_whitelist(msg.reply.id, msg.to.id)  then
rank = 'ÚÖæ ããíÒ ??'
else
rank = 'ãÌÑÏ ÚÖæ ??'
end
if msg.reply.username then usernamrxx = "@"..msg.reply.username else usernamrxx = " áÇ íæÌÏ ??" end
local rtba = '??? ÇáÇÓã : '..msg.reply.first_name..'\n??? ÇáãÚÑİ : '..usernamrxx..' \n??? ÇáÇíÏí : '..msg.reply.id..' \n??? ÇáÑÊÈå : '..rank
send_msg(msg.to.id,rtba , msg.id)
else
return "?? Óæí ÑÏ ááÚÖæ ÍÊå Çßáß Ôäæ ÑÊÈÊå????"
end
end

end
return {
  patterns = {
    "^(ã ÇáãØæÑ)$", 
    "^[/](start)$", 
    "^(ã5)$", 
    "^(ÇáÇæÇãÑ)$", 
    "^(ã1)$", 
    "^(ã2)$", 
    "^(ã3)$", 
    "^(ã4)$", 
    "^(ã6)$", 
    "^(ÇæÇãÑ ÇáãáİÇÊ)$", 
    "^(ãÚáæãÇÊí)$",
    "^(ãæŞÚí)$",
    "^(ÑİÚ ãØæÑ)$",
    "^(ÊäÒíá ãØæÑ)$",
    "^(ÑİÚ ãØæÑ) (%d+)$",
    "^(ÊäÒíá ãØæÑ) (%d+)$",
    "^(ÑİÚ ãØæÑ) (@[%a%d%_]+)$",
    "^(ÊäÒíá ãØæÑ) (@[%a%d%_]+)$",
    "^(ÇáãØæÑíä)$",
    "^(ÇáãÌãæÚÇÊ)$",
    "^(ÇáÇÔÊÑÇß)$",
    "^(ÇáÇÔÊÑÇß) ([123])$",
    "^(ãæÇáíÏí) (.+)/(.+)/(.+)",
    "^(ÔÍä) (%d+)$",
    "^(ÇĞÇÚå) (.*)$",
    "^(ÇáÎÑæÌ ÇáÊáŞÇÆí)$",
    "^(ÊİÚíá) (.*)$",
    "^(ÊÚØíá) (.*)$",
    "^(ÇáãØæÑ)$",
    "^(ÑÊÈÊí)$",
    "^(ÇáÑÊÈå)$",
    "^(ÇáÓæÑÓ)$",
    },
  run = run,
  pre_process = pre_process
}